# Dart - язык программирования

## Важные концепции

- Все что можно поместить в переменную является объектом, каждый объект является экземпляром класса. Числа, функции и даже `null` явлеяется объектом. Все объекты наследуются от класса `Object`.
- Хотя Dart строго типизирован, аннотации типов необязательны, поскольку Dart может определять типы. Если вы хотите явно сказать, что никакого типа не ожидается, используйте специальный тип `dynamic`.
- Dart поддерживает обобщения, такие как `List<int>` или `List<dynamic>`.
- Dart поддерживает функции верхнего уровня (такие как `main()`), также функции связанные с классами или объектами (статические или методы объектов). Можно также создавать функции внутри функций (вложенные или локальные)
- Dart поддерживает переменные верхнего уровня (глобальные), также как и связанные с классами или объектами. Переменные состояния также иногда называют полями или свойствами.
- Идендификатор, начинающийся со знака подчеркивания (_) является приватным.
- Идендификаторы могут начинаться со знака подчеркивания с последующим написанием любых букв и цифр.
- В Dart есть как выражения, так и операторы.(`condition ? expr1 : expr2` - `if() { } else { }`)
- Инструменты Dart могут сообщить о 2х типах проблем: предупреждения (warnings) и ошибки (errors).

## Переменные

Пример объявления и инициализации переменной:

```dart
var name = 'Bob';
```

Переменная - ссылка на объект. Переменная `name` содержит ссылку на объект типа `String` со значением "Bob".

Если объект не должен содержать значения определенного класса, то его можно описать типом `Object` или `dynamic`.

```dart
dynamic name = 'Bob';
```

Можно также явно указать тип переменной при её объявлении:

```dart
String name = 'Bob';
```

### Значение по-умолчанию

Не инициализированные переменные имеют значение `null`. Даже переменные числового типа инициализируются null-ом. Потому что в Dart всё является объектами.

```dart
int lineCount;
assert(lineCount == null);
```

> **Примечание**: Окончательный код игнорирует `assert()`. Во время дебагинга `assert(выражение)` выбрасывает ошибку, если результат выражения ложный.

### Final и const

Если значение переменной не должно меняться, то нужно использовать `final` или `const` вместо `var` . `final` - значение объявляется только один раз; `const` - постоянная времени компиляции. final верхнего уровня или переменная класса инициализируется во время первого использования.

>  **Примечание**: Переменная экземляра может быть `final` но не `const`. Final  объект должен быть инициализирован до начала тела конструктора - в месте описания параметров конструктора или в [листе инициализации](https://dart.dev/guides/language/language-tour#initializer-list) коструктора.

```dart
final name = 'Bob'; // без анотации типа
final String nickname = 'Bobby';
```

Если `const` находится в классе, то она помечается как статическая (`static`). В месте где объявляется константа значение устанавливается из таких же констант как цифровые или строчные литералы, другие константы, или результаты арифметических операций между числовыми константами.

```dart
const bar = 100000;
const double atm = 1.01325 * bar;
```

Ключевое слово `const` используется не только для объявления констант. Его можно использовать для создания константных значений при объявлении конструкторов. Любый переменные могут иметь константное значение.

```dart
var foo = const [];
final var = const [];
const baz = []; // равнозначно const []
```

Значение, которое не имеет анотацию `final` или `const` можно изменять, даже если его значение было объявлено с использование `const`:

```dart
foo = [1, 2, 3]; // было const []
```

### Встроеные типы

Dart поддерживает следующие типы:

- числа
- строки
- логический тип
- списки
- наборы
- словари
- руны (для выражения символо юникода в строке)
- символы

Некоторые из встроенных типов имеют свои конструкторы.

#### Числа

[int](https://api.dart.dev/stable/dart-core/int-class.html)

Целочисленные значения не больше 64 бит в зависимости от платформы. В Dart VM значения могут быть от -2<sup>63</sup> до 2<sup>63</sup> - 1. При компиляции в JavaScript допустимые значения -2<sup>53</sup> до 2<sup>53</sup> - 1.

[double](https://api.dart.dev/stable/dart-core/double-class.html)

Дробные числа двойной точности 64 бит.

`int` и `double` являются подтипами [num](https://api.dart.dev/stable/dart-core/num-class.html)

```dart
var x = 1; // int
var hex = 0xDEADBEEF; // int
var y = 1.1; // double
var exponents = 1.4e5; // double
double z = 1; // integer 1 convert to double 1.0
```

Строки можно конвертировать в числа  и наоборот:

```dart
// String -> int
var one = int.parse('1');
// String -> double
var onePointOne = double.parse('1.1');
// int -> String
String oneAsString = 1.toString();
// double -> String
String piAsString = 3.14159.toStringAsFixed(2); // '3.14'
```

Для целых числах есть побитовые операторы сдвига ( `<<` , `>>` ), и ( `&`), или ( `|` ):

```dart
3 << 1 // 0011 << 1 -> 0110
3 >> 1 // 0011 >> 1 -> 0001
3 | 4  // 0011 | 0100 -> 0111
```

#### Строки

Строки в Dart являются последовательностью из символов UTF-16. Для их создания можно использовать двойные или одинарные ковычки.

```dart
var s1 = 'Single quotes work well for string literals.';
var s2 = "Double quotes work just as well.";
var s3 = 'It\'s easy to escape the string delimiter.';
var s4 = "It's even easier to use the other delimiter.";
```

Возможно вставлять выражение в строку используя `${выражение}`. Также можно вставлять идентификатор переменной, тогда {} можно опустить. Чтобы получить строку соответсвующую объекту можно вызвать метод `toString()`.

```dart
var s = 'интерполяция строк';

assert('В Dart есть $s, которая очень удобна.' ==
    'В Dart есть интерполяция строк, ' +
        'которая очень удобна.');
assert('${s.toUpperCase()} очень удобна!' ==
        'ИНТЕРПОЛЯЦИЯ СТРОК очень удобна!');
```

Сцепить строки можно при помощи оператора `+`:

```dart
var s1 = 'Оператор + ' + 'работает хорошо.';
var s2 = 'Конкатенация строк работает даже если'
    	  "строка разорвется.";
```

Для создание многострочной записи используются тройные одинарные или двойные ковычки:

```dart
var s1 = '''
Вы можете создать
многострочню запись вот так.
''';

var s2 = """Это также
многострочная запись.""";
```

Можно создать строку с игнорированием escape-последовательностей и спецсимволов:

```dart
var s = r'В raw-строке даже \n не получает особого отношения';
```

Строковой литерал является константой времени компиляции если он состоит также из выражений констант времени компиляции таких как null или числа, строки или логические переменные.

```dart
// Это работает в строковой константе
const aConstNum = 0;
const aConstBool = true;
const aConstString = 'строковая константа';

// Это работает в строковой константе
var aNum = 0;
var aBool = true;
var aString = 'строка';
const aConstList = [1, 2, 3];

const validConstString = '$aConstNum $aConstBool $aConstString';
// const invalidConstString = '$aNum $aBool $aString $aConstList';
```

#### Логический тип

Логический тип имеет только два объекта `true` и `false`, которые являются константами времени компиляции.

В Dart не возможно использовать не булево выражение в `if` или `assert`. Вместо этого нужно явно проверять значение переменной:

```dart
// Проверка пуста ли строка
var fullName = '';
assert(fullName.isEmpty);

// Проверка на ноль
var hitPoints = 0;
assert(hitPoints <= 0);

// Проверка на null
var unicorn;
assert(unicorn == null);

// Проверка на NaN.
var iMeantToDoThis = 0 / 0;
assert(iMeantToDoThis.isNaN);
```

#### Списки 

[List](https://api.dart.dev/stable/dart-core/List-class.html)

В Dart массивы - это объекты `List`.

```dart
var list = [1, 2, 3];
```

> **Примечание**: `list` имеет тип `List<int>`. Если попробовать добавить в этот список не целочисленно значение, то это приведет к ошибке.

Можно добавить запятую после последнего элемента списка. Эта запятая не будет влиять на всю коллекцию, но это поможет избежать ошибок копирования.

```dart
var list = [
  'Car',
  'Boat',
  'Plane',
];
```

Нумерация в списках начинается с нуля.

```dart
var list = [1, 2, 3];
assert(list.length == 3);
assert(list[1] == 2);

list[1] = 1;
assert(list[1] == 1);
```

Чтобы создать список, который является константой времени компиляции, нужно добавить `const` до списочного литерала:

```dart
var constantList = const [1, 2, 3];
// constantList[1] = 1; // This line will cause an error.
```

Dart 2.3 появиля spread-оператор (`...`) и spread-оператор с нулевым значением (`...?`), которые обеспечивают краткий способ вставки нескольких значений в коллекцию.

```dart
var list = [1, 2, 3];
var list2 = [0, ...list];
assert(list2.length == 4);
```

Если значение выражения справа от spread-оператора может быть null, то нужно использовать spread-оператор с нулевым значением (`...?`)

```dart
var list;
var list2 = [0, ...?list];
assert(list2.length == 1);
```

При создании списков можно использовать условные конструкции и циклы:

```dart
var nav = [
  'Home',
  'Furniture',
  'Plants',
  if (promoActive) 'Outlet'
];

var listOfInts = [1, 2, 3];
var listOfStrings = [
  '#0',
  for (var i in listOfInts) '#$i'
];
```

#### Наборы

[Set](https://api.dart.dev/stable/dart-core/Set-class.html)

Набор в Dart это неупорядоченная коллекция уникальных значений.

```dart
// halogens имеет тип Set<String>
var halogens = {'fluorine', 'chlorine', 'bromine', 'iodine', 'astatine'};
```

Для создания набора можно использовать пустую `{}`, которой предшевствует тип, или назначить `{}` переменной типа `Set`:

```dart
var names = <String>{};
Set<String> something = {}; 
// var names = {}; // компилятор не поймет какого типа набор
```

>  **Примечание**: Поскольку словари (`Map`) в Dart появились раньше наборов, то если забыть анотацию к `{}`, то для переменной создастся объект типа `Map<dynamic, dynamic>`

Для добавление элементов к существующему набору используются `add()` или `addAll()` методы:

```dart
var elements = <String>{};
elements.add('fluorine');
elements.addAll(halogens);
```

Для получения количества элементов в наборе используется `.length`:

```dart
assert(elements.length == 5);
```

Чтобы создать набор, который является константой времени компиляци, нужно добавлять `const` до установки литералов:

```dart
final constantSet = const {
  'fluorine',
  'chlorine',
  'bromine',
  'iodine',
  'astatine',
};
// constantSet.add('helium'); // Эта строка содержит ошибку.
```

Наборы также поддерживают spread-оператор (`...`), nullspread-operator (`...?`), условные конструкции (`if`) и циклы (`for`), также как и списки.

#### Словари

[Map](https://api.dart.dev/stable/dart-core/Map-class.html)

Словари состоят из ключей и значений. И ключи, и значения могут быть объектами любого типа. Ключ является уникальным, а значение может встречаться в словаре сколько угодно раз.

```dart
var gifts = {
  // Key:    Value
  'first': 'partridge',
  'second': 'turtledoves',
  'fifth': 'golden rings'
};

var nobleGases = {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};
```

Словари можно создать и инициализировать по другому:

```dart
var gifts = Map();
gifts['first'] = 'partridge';
gifts['second'] = 'turtledoves';
gifts['fifth'] = 'golden rings';

var nobleGases = Map();
nobleGases[2] = 'helium';
nobleGases[10] = 'neon';
nobleGases[18] = 'argon';
```

> **Примечение**: словарь можно создать и так `new Map()`, но слово `new` в Dart не обязательно.

```dart
// инициализация словаря
var gifts = {'first': 'partridge'};
// добавление новой пары ключ-значение
gifts['fourth'] = 'calling birds'; 
// получение значения из словаря по ключу
assert(gifts['first'] == 'partridge');
// проверка имеется ли ключ в словаре
assert(gifts['fifth'] == null);
// количество пар в словаре
assert(gifts.length == 2);
```

Словарь можно создать как константу времени компиляции при помощи `const`:

```dart
final constantMap = const {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};

// constantMap[2] = 'Helium'; // This line will cause an error.
```

Словари поддерживают spread-оператор (`...`), nullspread-operator (`...?`), условные конструкции (`if`) и циклы (`for`).

#### Руны и графемы

[Runes](https://api.dart.dev/stable/2.10.4/dart-core/Runes-class.html)

В Dart руны раскрывают кодовые точки Unicode строки.

Юникод определяет уникальное числовое значение для каждой буквы, цифры и символа, используемых во всех мировых системах письма. Поскольку строка Dart представляет собой последовательность кодовых единиц UTF-16, для выражения кодовых точек Unicode внутри строки требуется специальный синтаксис. Обычный способ обозначения кодовой точки Unicode - `\uXXXX`, где `XXXX` - 4-значное шестнадцатеричное значение. Например, символ сердца (`♥`) - `\u2665`. Чтобы указать более или менее 4 шестнадцатеричных цифр, заключите значение в фигурные скобки. Например, смеющийся смайлик (`😆`) - это `\u{1f606}`.

Если нужно прочитать или записать отдельные символы Unicode, нужно использовать метод получения символов, определенный в `String` пакет символов. Возвращенный объект `Characters` представляет собой строку как последовательность графем.

```dart
import 'package:characters/characters.dart';
...
var hi = 'Hi 🇩🇰';
print(hi);
print('The end of the string: ${hi.substring(hi.length - 1)}');
print('The last character: ${hi.characters.last}\n');
```

Результат:

```
$ dart bin/main.dart
Hi 🇩🇰
The end of the string: ???
The last character: 🇩🇰
```

#### Символы

[Symbol](https://api.dart.dev/stable/2.10.4/dart-core/Symbol-class.html)

Объект `Symbol` представляет собой оператор или идентификатор, объявленный в программе Dart. Возможно, вам никогда не понадобится использовать символы, но они бесценны для API, которые ссылаются на идентификаторы по имени, потому что минификация изменяет имена идентификаторов, но не символы идентификаторов.

Чтобы получить символ для идентификатора, используйте литерал символа, который представляет собой просто `#`, за которым следует идентификатор:

```dart
#radix
#bar
```

## Функции



